import numpy as np
from tensorflow import keras
import joblib

def test_prediction_unit():
    try:
        model = keras.models.load_model('src/models/augmented_andmark_model_v1.keras')
        scaler = joblib.load('src/artifacts/csv_model/augmented/scaler.pkl')
    except Exception as e:
        raise RuntimeError(f"Error in loading model: {e}")
    
    # Fixed default input
    test_input = np.array([
        0.5380982160568237,0.7686852216720581,1.554153215010956e-07,0.6206050515174866,0.6583099961280823,0.05341210216283798,0.6281765103340149,
        0.5639907717704773,0.040134962648153305,0.628364622592926,0.4979516565799713,0.005820660386234522,0.6451971530914307,0.4169086515903473,
        -0.03974826633930206,0.5706412196159363,0.4486195743083954,-0.04232655093073845,0.5598310828208923,0.3110206127166748,-0.11001574993133545,
        0.5588979721069336,0.2149084210395813,-0.1603449583053589,0.5564948320388794,0.13763496279716492,-0.20080552995204926,0.5458441376686096,
        0.48092594742774963,-0.12790250778198242,0.5294228196144104,0.31957918405532837,-0.21109823882579803,0.527291476726532,0.20928362011909485,
        -0.2721559703350067,0.5248522758483887,0.11987996101379395,-0.32022783160209656,0.5229790806770325,0.5345970988273621,-0.2090468406677246,
        0.4990665316581726,0.386746883392334,-0.28252479434013367,0.4904222786426544,0.283290296792984,-0.32741981744766235,0.486091285943985,
        0.19743812084197998,-0.364546537399292,0.504065215587616,0.600749671459198,-0.2841510474681854,0.480385422706604,0.5023211240768433,
        -0.35690009593963623,0.4768211245536804,0.42410722374916077,-0.3950648009777069,0.47709691524505615,0.3558228313922882,-0.42692452669143677
    ]).reshape(1,-1)

    input_scaled = scaler.transform(test_input)
    prediction = model.predict(input_scaled)

    assert prediction.shape[1] > 0 # at least one class predicted
    


